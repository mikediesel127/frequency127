<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="color-scheme" content="dark light"/>
  <title>Frequency127</title>

  <!-- prevent flash of unstyled content -->
  <style>body{opacity:0;transition:opacity .2s ease}</style>
  <script>window.addEventListener('load',()=>document.body.style.opacity=1)</script>

  <link rel="preload" href="/assets/styles.css" as="style"/>
  <link rel="stylesheet" href="/assets/styles.css"/>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="dot"></span>
      <span class="word">Frequency127</span>
    </div>
    <div class="actions">
      <button id="btn-theme" class="icon ghost" title="Theme" aria-label="Toggle theme">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z" stroke="currentColor" stroke-width="1.5"/></svg>
      </button>
      <button id="btn-logout" class="ghost" hidden>Logout</button>
    </div>
  </header>

  <main id="app" class="shell">
    <!-- AUTH -->
    <section id="auth-view" class="auth-wrap">
      <div class="card auth">
        <h2 class="t-center">Welcome</h2>
        <p class="muted t-center">Local-first feel. Private. Minimal.</p>

        <form id="login-form" class="stack gap-md" autocomplete="on">
          <label class="field">
            <input id="login-username" name="username" required minlength="3" maxlength="24" pattern="[a-zA-Z0-9_.~-]{3,24}" />
            <span>Username</span>
          </label>
          <label class="field">
            <input id="login-passcode" name="passcode" inputmode="numeric" required minlength="4" maxlength="4" pattern="[0-9]{4}" />
            <span>4-digit passcode</span>
          </label>
          <div class="row">
            <button class="primary grow" id="btn-login" type="submit">Sign in</button>
            <button class="ghost" id="btn-to-signup" type="button">Create</button>
          </div>
        </form>

        <form id="signup-form" class="stack gap-md" hidden autocomplete="on">
          <label class="field">
            <input id="signup-username" name="username" required minlength="3" maxlength="24" pattern="[a-zA-Z0-9_.~-]{3,24}" />
            <span>Username</span>
          </label>
          <label class="field">
            <input id="signup-passcode" name="passcode" inputmode="numeric" required minlength="4" maxlength="4" pattern="[0-9]{4}" />
            <span>4-digit passcode</span>
          </label>
          <div class="row">
            <button class="primary grow" id="btn-signup" type="submit">Create</button>
            <button class="ghost" id="btn-to-login" type="button">Back</button>
          </div>
        </form>

        <p id="auth-error" class="error t-center" role="alert" hidden></p>
      </div>
    </section>

    <!-- APP -->
    <section id="shell" class="grid two" hidden>
      <!-- Sidebar -->
      <aside class="panel">
        <div class="card profile">
          <div class="row space-between">
            <div class="row">
              <div class="avatar-dot"></div>
              <div>
                <div id="me-username" class="username mono"></div>
                <div class="muted tiny">Logged in</div>
              </div>
            </div>
            <button id="btn-share-profile" class="icon ghost" title="Share profile" aria-label="Share profile">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 12v7a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-7M16 6l-4-4-4 4M12 2v14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            </button>
          </div>
        </div>

        <div class="card stats">
          <div class="stat">
            <div class="value" id="stat-xp">0</div>
            <div class="label">XP</div>
          </div>
          <div class="stat">
            <div class="value" id="stat-level">1</div>
            <div class="label">Level</div>
          </div>
          <div class="stat">
            <div class="value" id="stat-streak">0</div>
            <div class="label">Streak</div>
          </div>
        </div>

        <div class="card">
          <h3>Theme</h3>
          <div class="row wrap">
            <button class="chip" data-theme="auto">Auto</button>
            <button class="chip" data-theme="dark">Dark</button>
            <button class="chip" data-theme="light">Light</button>
          </div>
        </div>

        <div class="card">
          <h3>Recently active</h3>
          <div id="recent-users" class="chips"></div>
        </div>
      </aside>

      <!-- Main -->
      <section class="panel">
        <div class="row space-between headrow">
          <h2>Routines</h2>
          <div class="row">
            <button id="btn-new-routine" class="primary pill">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
              New
            </button>
          </div>
        </div>

        <ul id="routine-list" class="list"></ul>
        <p id="empty-state" class="muted t-center" hidden>No routines yet. Tap “New”.</p>
      </section>
    </section>
  </main>

  <!-- Create/Edit Routine Modal -->
  <dialog id="routine-editor" class="modal">
    <form method="dialog" class="card modal-card">
      <header class="row space-between">
        <h3 id="re-title">New routine</h3>
        <button class="icon ghost" value="close" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M18 6 6 18M6 6l12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </header>

      <div class="stack gap-md">
        <label class="field">
          <input id="re-name" required maxlength="48"/>
          <span>Name</span>
        </label>

        <div>
          <div class="muted tiny">Add steps</div>
          <div id="re-steps" class="chips">
            <button type="button" class="chip" data-type="box">Box Breathing</button>
            <button type="button" class="chip" data-type="affirm">Affirmations</button>
            <button type="button" class="chip" data-type="white">White-Light</button>
          </div>
        </div>

        <ol id="re-queue" class="queue"></ol>
      </div>

      <footer class="row space-between">
        <button class="ghost" value="close">Cancel</button>
        <button class="primary" id="re-save" value="save">Save</button>
      </footer>
    </form>
  </dialog>

  <!-- Runner Modal -->
  <dialog id="runner" class="modal">
    <form method="dialog" class="card modal-card">
      <header class="row space-between">
        <h3 id="run-title">Routine</h3>
        <button class="icon ghost" value="close" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M18 6 6 18M6 6l12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </header>

      <div id="run-body" class="run-body"></div>

      <footer class="row space-between">
        <button class="ghost" value="close">Close</button>
        <button class="primary" id="run-next">Next</button>
      </footer>
    </form>
  </dialog>

  <!-- Routine list item template -->
  <template id="tpl-routine-item">
    <li class="item card">
      <div class="row space-between">
        <div class="row titlebox">
          <button class="icon caret" aria-label="Expand">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg>
          </button>
          <div class="title"></div>
        </div>
        <div class="row">
          <button class="icon pill run" title="Run">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M8 5v14l11-7-11-7z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>
          </button>
          <button class="icon ghost edit" title="Edit">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z" stroke="currentColor" stroke-width="1.4"/></svg>
          </button>
          <button class="icon ghost danger del" title="Delete">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M3 6h18M8 6v14m8-14v14M9 6l1-2h4l1 2" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
      <div class="meta muted tiny steps"></div>
      <div class="collapse">
        <div class="muted tiny">Steps</div>
        <ul class="steps-list"></ul>
      </div>
    </li>
  </template>

  <button id="fab-new" class="fab" title="New routine" aria-label="New routine">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
  </button>

  <script defer src="/assets/app.js"></script>
</body>
</html>
